---
layout:     post
title:      Git暂存区的意义
subtitle:   我理解的stage
date:       2018-12-07
author:     mengxun
header-img: img/pipenv.jpg
catalog: true
tags:
    - Git

---

### 思考

`git add`的命令会把当前工作区里的文件提到暂存区，不过我平常都喜欢用`git commit -am`这种直接跳过暂存这个环节，因为我就算`add`了，也还是要`commit`，不如两步并一步好了。那么暂存区这个东西究竟有什么存在意义呢，用了这么久的Git好像也没有真的理解这个概念。

### 个人理解

我设想了一个场景：

- 现在有一个文件做了一些修改
- 但是呢，现在无法确定这个A修改方案可行与否，一会很可能会再换种B方案试试
- 过了一会换了B方案，但是又觉得A方案好，然后想再换回去A方案
- 那么现在就需要做个版本控制了，去控制这A、B两种方案

那么针对这种情形，完全可以把两个方案搞到两个`branch`上，然后A方案有一个`branch`，叫做branch_A，B方案也有一个`branch`叫做branch_B，这两个`branch`来回切换两个版本，版本控制本来就是Git存在的意义。

```
$git branch
branch_A
branch_B
```

但是这种办法有些繁琐，要新建两个`branch`，然后来回`checkout`两个`branch`，最后决定要哪个方案的时候还要merge，而且很有可能有冲突，还要再手动解决冲突。

最关键的问题是A和B两种方案本来就是暂时的，这两个方案最终只会取一个，**完全没必要两个方案都提交到版本库**。

那么能不能先试试A方案，然后把A方案暂存起来，再改到另一种B方案再试试，最后两种方案都试过之后，最终确定一种方案再提交到版本库呢？

**其实这就是暂存区的作用了**，有了暂存区之后，就可以把A方案放在暂存区，B方案放在工作区。

- 如果想要A方案，就直接`commit`暂存区里的A方案就好了，B方案`checkout`撤销掉。
- 如果想要B方案，那就`add`进去覆盖A方案然后`commit`即可。

这样的话，只会在一个分支上产生一次`commit`，干净利落。

#### 总结

暂存区其实就是在你短期内犹豫不决的时候，给你一个暂存文件的地方，这样工作区和暂存区就好像两个分支一样，让你选择，但是这一切都毫无痕迹而且很方便。













